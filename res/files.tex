\input{main.tex}

\title{Lær Python dag 3 - modul 1}
\subtitle{Filer}

\begin{document}

\maketitle

\begin{frame}{Indhold}
  \setbeamertemplate{section in toc}[sections numbered]
  \tableofcontents[hideallsubsections]
\end{frame}

\section{Hvad bruger vi filer til?}

\begin{frame}{Filer og programmering}
	Filer bruges i flere sammenhænge:
	\begin{itemize}
		\item Gemme data til senere brug (persist til disk)
		\item Skriv output fra program til en filer
		\item Tag input fra en fil
	\end{itemize}
\end{frame}

\section{Filer i python}

\begin{frame}[fragile]{Åben/luk en fil}
	Vi åbner en fil med methoden \texttt{open()} som returnerer et filobjekt:
	\begin{lstlisting}[style=python]
f = open(<file>, <mode>)
	\end{lstlisting}
	Tager parametrene \texttt{file} og \texttt{mode}:
	\begin{itemize}
		\item File: Stien til den fil som skal åbnes (string).
		\item Mode: Hvordan skal filen bruges "r" for læs, "w" for skriv.
	\end{itemize}
	Når man er færdig med filen skal den lukkes (for at frigøre ressourcer):
	\begin{lstlisting}[style=python]
f.close()
	\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{Læs fra en fil}
	Læs filen \texttt{min\_fil.txt} på følgende vis:
	\begin{lstlisting}[style=python]
f = open("min_fil.txt", "r")
print(f.read())
f.close()
	\end{lstlisting}
	Dette giver output:
	\begin{lstlisting}[style=python]
Hej med jer
Dette er en fil
	\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Læs fra en fil}
	Vi kan også læsen filen linje for linje:
	\begin{lstlisting}[style=python]
f = open("min_fil.txt", "r")
line = f.readline()
while line:
	print(line.rstrip())
	line = f.readline()
f.close()
	\end{lstlisting}
	Kan også gøres således:
	\begin{lstlisting}[style=python]
f = open("min_fil.txt", "r")
for line in f:
	print(line.rstrip())
f.close()
	\end{lstlisting}
	\texttt{rstrip()} fjerner whitespace for enden af linjen (undgår ekstra linjeskift).
\end{frame}

\begin{frame}[fragile]{Skriv til en fil}
	Skriv til filen \texttt{min\_fil.txt} på følgende vis:
	\begin{lstlisting}[style=python]
f = open("min_fil.txt", "w")
f.write("Lær python!!!\n")
f.write("IMADA SDU")
f.close()
	\end{lstlisting}
	\texttt{\textbackslash n} er en new-line-karakter og tilføjer derved et linjeskift i filen.\\
	Filen ser nu således ud:
	\begin{lstlisting}[style=python]
Lær python!!!
IMADA SDU
	\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Exceptions}
	Hvis vi skriver til en fil som ikke eksistere oprettes en ny.\\
	Hvad sker der hvis vi prøver at læse en fil som ikke eksisterer?\\
	\pause
	Her prøver vi at læse den ikke eksisterende fil \texttt{ikke\_eksisterende\_fil.txt}:
	\begin{lstlisting}[style=python]
  File "C:/Users/SBK/Documents/GitHub/Scripts/python_course/test.py", line 18, in <module>
    f = open("ikke_eksisterende_fil.txt", "r")
FileNotFoundError: [Errno 2] No such file or directory: 'ikke_eksisterende_fil.txt'
	\end{lstlisting}
	Programmet fejler! og stopper med en fejl.
\end{frame}

\begin{frame}[fragile]{Exceptions}
	Vi kan dog fange denne fejl (aka. exception), og give en bedre fejlmeddelelse, eller alt efter fejlen rette op på den.\\
	Dette gøres via \texttt{try} og \texttt{except}:
	\begin{lstlisting}[style=python]
f = None
try:
	f = open("ikke_eksisterende_fil.txt", "r")
	print(f.read())
	f.close()
except:
	if f is not None:
		f.close()
	print("filen kunne ikke åbnes") # fejlmeddelelse
	\end{lstlisting}
Vi er her meget forsigtige i except-blokken og sørger for at lukke filen, hvis der er blevet initaliseret.
\end{frame}

\begin{frame}[fragile]{Exceptions}
	Vi kan også fange en specifik fejl:
	\begin{lstlisting}[style=python]
f = None
try:
	f = open("ikke_eksisterende_fil.txt", "r")
	print(f.read())
	f.close()
except FileNotFoundError:
	if f is not None:
		f.close()
	print("filen kunne ikke åbnes")
	\end{lstlisting}

\end{frame}

\section{Extras}

\begin{frame}[fragile]{List comprehensions}
	List comprehensions er et værktøj til kort at lave nye lister ud fra gamle lister. Man skriver forrest hvilket/hvilke elementer man vil have, og bagved skriver man hvor de elementer skal komme fra og evt. nogle betingelser.
	\begin{columns}
		\column{0.4\textwidth}
		\begin{lstlisting}[style=python]
ages = [9,  49, 42, 12, 55,
        28, 44, 55, 16, 24, 
        5,  58, 29, 7,  27, 
        20, 52, 38, 31, 33]
children = [age for age in ages if age <= 12]
print(children)
		\end{lstlisting}
		
		\pause
		\column{0.4\textwidth}
		\begin{lstlisting}[style=python]
[9, 12, 5, 7]
		\end{lstlisting}
	\end{columns}
\end{frame}

\begin{frame}[fragile]{Zip}
	Hvis man har to lister hvor det første element i den ene liste hører sammen med første element i den anden liste, andet element hører sammen osv. Så kan man kombinere dem til en enkelt liste med disse par, ved hjælp af zip funktionen.
	\begin{columns}
		\column{0.4\textwidth}
		\begin{lstlisting}[style=python]
letters = ['a','b','c','d']
numbers = [1, 2, 3, 4]
for pair in zip(letters, numbers):
	print(pair)
		\end{lstlisting}
		
		\pause
		\column{0.4\textwidth}
		\begin{lstlisting}[style=python]
('a', 1)
('b', 2)
('c', 3)
('d', 4)
		\end{lstlisting}
	\end{columns}
\end{frame}

\begin{frame}[fragile]{Assert}
	Ofte når man programmerer, tænker man at tingene er på en bestemt måde, og ofte tager man fejl. Hvis man gerne vil sikre at f.eks. en variabel har en bestemt type eller en bestemt værdi, så kan man bruge funktionen assert(). Det kan f.eks. bruges i starten af en funktion til at sikre korrekt input.
	\begin{lstlisting}[style=python]
def increment(x):
	assert(type(x) is int), "Kan kun inkrementere heltal"
	return x+1

print(increment(4.0))
	\end{lstlisting}
	
	\begin{lstlisting}[style=python]
def divide(x, y):
	assert(y != 0), "Du må ikke dividere med 0"
	return x/y

print(divide(5, 0))
	\end{lstlisting}
\end{frame}

\end{document}